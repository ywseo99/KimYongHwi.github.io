---
title: "내가 이해한대로 정리한 GraphQL 1편"
date: 2019-07-25 18:26:28 -0400
categories: graphql
tags: [graphql]
---

# 1. GraphQL이란
오늘날 대부분의 client는 API를 통해 필요한 데이터를 전달 받는데 이때 API는 client에서 필요로 하는 데이터에 대한 interface를 제공해야할 책임이 있다.

기존의 REST API는 데이터의 대한 interface가 추가될 때마다 새로운 endponit를 필요로 했고 API의 버전이 올라갈 수록 또는 API의 규모가 커질 수록 이런 endpoint는 무수히 늘어나 관리가 어려워진다.

이러한 문제점을 해결하기 위해 Facebook에서는 GraphQL이라는 새로운 API 표준을 제시했다.

GraphQL은 API를 위한 Query Language이면서 query를 실행시기키 위한 runtime이다. GraphQL을 사용하게 되면 여러 endpoint 대신 서버는 single endpoint 만 노출하고 client는 자신이 필요한 데이터를 query를 통해 서버로부터 받아 올 수 있다.

# 2. 장점
- Ask for what you need, get exactly that
  - client에서는 query를 통해 원하는 데이터를 받아올 수 있어 over fetching, under fetching이 없다.

- Get many resources in a single request
  - user 정보, user가 작성한 posts, user의 followers를 API로 부터 받는 과정을 보면 Rest는 3개의 endpoint에 3번의 request를 보내는 반면
  GraphQL은 query를 통해 1번의 request로 원하는 데이터를 모두 받아올 수 있다.
  - Rest
    <img width="939" alt="스크린샷 2019-08-29 오전 11 55 15" src="https://user-images.githubusercontent.com/44759868/63907159-5c3c5700-ca55-11e9-9a93-a2815b71dda1.png">
    > https://www.howtographql.com/basics/1-graphql-is-the-better-rest
  - GraphQL
    <img width="943" alt="스크린샷 2019-08-29 오전 11 56 41" src="https://user-images.githubusercontent.com/44759868/63907037-dd471e80-ca54-11e9-8473-d795e1686394.png">
    > https://www.howtographql.com/basics/1-graphql-is-the-better-rest

- Describe what's possible with a type system
  - GraphQL에서는 type system을 가지고 API에서 제공 가능한 데이터의 대한 interface를 정의할 수 있다.
  - 정의되지 않은 type 또는 field를 요청할 경우 이에 대한 error를 제공하는데 유용한다.

- Evolve your API without versions

# 3. Core concept

## 3.1 The Schema Definition Language (SDL)
GraphQL은 type system을 가지고 있으며, 이를 사용해 API의 스키마를 정의한다. 스키마를 작성하기 위해 사용하는 문법을 SDL이라고 한다.

SDL을 통해 다음을 정의할 수 있다.
- type
- Query
- Mutation
- Subscription

```
type Person {
  id: ID
  name: String
  age: Int
  posts: [Post]
}

type Post {
  title: String
  author: Person
}

type Query {
  getPeople(from: Int, size: Int): [Person]
}

type Mutation {
  createPerson(name: String, age: Int): Person
}

type Subscription {
  newPerson: Person
}
```

위 예시는 Person과 Post에 대한 type을 정의하고 그에 대한 Query, Mutation, Subscription이다. 

Person과 Post는 Person을 기준으로 one-to-many 관계를 가지고 있기 때문에 Person의 post field는 Array인것을 알 수 있다.

모든 GraphQL 서비스는 해당 서비스에서 쿼리 가능한 데이터들을 완벽하게 설명하는 타입들을 정의하고, 쿼리가 들어오면 해당 스키마에 대해 유효성이 검사된 후 실행된다.

type에 정의되지 않은 필드를 요구하거나 query(GET), mutation(POST, PUT, DELETE)를 실행할 때 필드의 형(Data type)이 다를 경우 GraphQL에서는 error를 리턴하기 때문에 동적 타입 언어에서도 형(Data type)에 대한 안정성을 확보할 수 있다.

## 3.2 Query
## 3.3 Mutation
## 3.4 Subscription


## 참조
- [GraphQL](https://graphql.org/)
- [How to GraphQL](https://www.howtographql.com/)
